<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
		<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-indigo.min.css" />
		<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>	
		<link rel="stylesheet" href="styles/timetablejs.css">
		<link rel="stylesheet" href="style.css">
		<script src="moment.js"></script> 
		<script src="combodate.js"></script> 
	</head>
<body>
<!--Main page -->		
<firebase-auth id="auth" app-name="teachme-7ed11"></firebase-auth>		
<div class="mdl-layout mdl-js-layout">
   <header class="mdl-layout__header">
      <div class="mdl-layout-icon"></div>
      <div class="mdl-layout__header-row">
         <span class="mdl-layout__title" onclick="window.location.href='index.html'">Teach me</span>
         <span class="extraspace">  </span>
         <span class="extraspace">  </span>
         <div class="mdl-layout-spacer"></div>
         <nav class="mdl-navigation">
			 
<span class="extraspace"> </span>
<a href="areaAlumno.html"> 
	<button id="intranetButton" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
Intranet
		<i class="button-righ-icon material-icons">account_circle</i>
	</button>
</a> 
<!-- Accent-colored raised button -->
<span class="extraspace"> </span>
<a href="hp.html">
	<button id="profesorButton" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
Hazte profesor!
		<i class="button-righ-icon material-icons">account_circle</i>
	</button>
</a>	
<span class="extraspace"> </span> 
<!-- Accent-colored raised button -->	
<a href ="index.html"></a>
	<button id="logoutButton" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
Sign out
		<i class="button-righ-icon material-icons">account_circle</i>
	</button>
</a>
         
            
         </nav>
      </div>
   </header>
   <div class="mdl-layout__drawer">
   </div>
</div>
<div id="div1ClasesAlumno">
	<h6>Conoce a tu profesor</h6>
	<h7>Revisa el calendario, elige un fecha y haz click en guardar</h7>
</div>

<div id="div2ClasesAlumno">
	<table id="tablaContrataClase2" class="mdl-data-table mdl-js-data-table">
  		<thead>
			<tr>
      			<th class="mdl-data-table__cell--non-numeric" style="text-align: center;">Nombre</th>
      			<th class="mdl-data-table__cell--non-numeric" style="text-align: center;">Te voy a enseñar</th>
      			<th class="mdl-data-table__cell--non-numeric" style="text-align: center;">Language</th>
				<th class="mdl-data-table__cell--non-numeric" style="text-align: center;">Video</th>
    		</tr>
  		</thead>
  		<tbody>
			<tr>
				<td id=nameProf class="mdl-data-table__cell--non-numeric" style="text-align: center;"><h6></h6></td>
      			<td id="teachProf" class="mdl-data-table__cell--non-numeric" style="text-align: center;"></td>
      			<td id="langProf" class="mdl-data-table__cell--non-numeric"></td>
				<td  id="video" class="mdl-data-table__cell--non-numeric">
					<!--iframe width="560" height="315" src="https://www.youtube.com/embed/yUzdZ4hAFBs" frameborder="0" allowfullscreen></iframe-->
    		</tr>
  		</tbody>
	</table>
</div>
	
<div id="div3ClasesAlumno">
	<input type="date"/>
	<span></span>
	<!-- Accent-colored raised button with ripple -->
	<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
  		Guardar
	</button>
	<span></span>
	<span></span>
	<button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
  		Volver
	</button>
</div>	
	
<div class="timetable"></div>		
<span></span>

</body>

	<script src="https://www.gstatic.com/firebasejs/4.1.3/firebase.js"></script>
	<script>
  	// Initialize Firebase
  		var config = {
    		apiKey: "AIzaSyCr2wfyL15rtEmQJsy-mGuc3URImSdNraQ",
    		authDomain: "teachme-7ed11.firebaseapp.com",
    		databaseURL: "https://teachme-7ed11.firebaseio.com",
    		projectId: "teachme-7ed11",
    		storageBucket: "teachme-7ed11.appspot.com",
    		messagingSenderId: "147010117223"
  		};
  		firebase.initializeApp(config);
	</script>

	<script src="scripts/timetable.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script type='text/javascript' src="functions.js"></script>		
	<script>
		// Nos pasan el id en la url, parseamos y hacemos retrieve de esa info en fb
		var url = window.location.href;
		var search = url.split("?");
		var searchfb = search[1].slice(3);
		firebase.database().ref('/prof/' + searchfb).once('value').then(function(snapshot) {
  			var lang = snapshot.val().lang;
			var name = capitalizeFirstLetter(snapshot.val().name);
			var teach = capitalizeFirstLetter(snapshot.val().teach);
			var videourl = snapshot.val().videourl;
		 	
					
		document.getElementById("nameProf").innerHTML = name;
		document.getElementById("langProf").innerHTML = lang;
		document.getElementById("teachProf").innerHTML = teach;
		document.getElementById("video").innerHTML = videourl;
		});
		
		function capitalizeFirstLetter(string) {
    		return string.charAt(0).toUpperCase() + string.slice(1);
		}
	</script>
	<script>

		// Obtenemos id del profesor
			var url = window.location.href;
			var search = url.split("?");
			var idProfesor = search[1].slice(3);
		console.log(idProfesor);
		
		// Función para guardar la clase 
		function getEventFromDB(idProfesor){
			var ref = firebase.database().ref('clases/' + idProfesor); 
			ref.once('value').then(function(snapshot) {
				snapshot.forEach(function(childSnapshot) {
      		// Traigo snapshot y le saco los datos
      		// childData will be the actual contents of the child
      			var location = childSnapshot.val().location;
				var inicio = childSnapshot.val().inicio;
				var final = childSnapshot.val().final;
					
				//timetable.addEvent('Ocupado',location, new Date(2017,8,19,inicio,00), new Date(2017,8,19,final,00));	
  				//var param = "'Ocupado',Lunes, new Date(2017,8,19,10,00), new Date(2017,8,19,11,00)";
				timetable.addEvent(param);
				renderer.draw('.timetable');
				})
				
		})
		}
		
		/*
		// Función para traer la info que hay en BD
		function addEventFromHTML (dia, horai, minutosi, horaf, minutosf){
			
			var month = Date.now().getMonth();
			Date date = new Date("2017", month, "1", "1", "1");
			
			console.log(date.toDateString);
			
			var postData = "hola";
			var currentUser = firebase.auth().currentUser;
			var uuid = currentUser.uid;
			
			// Añadimos a BD clases
			var ref = firebase.database().ref();	
	
				
			console.log(uuid);
			
			
			// Get a key for a new Post.
  			var newPostKey = firebase.database().ref().child('/clases/' + idProfesor).push().key;
  			// Write the new post's data simultaneously in the posts list and the user's post list.
  			var updates = {};
  			updates['clases/' + idProfesor +'/'+ newPostKey] = postData;
  			updates['alumno/' + uuid + '/' + newPostKey] = postData;

  			return firebase.database().ref().update(updates);	
			
			// Añadimos a la tabla
			timetable.addEvent('Ocupado',dia, new Date(2017,8,19,inicio,00), new Date(2017,8,19,fin,00));
			renderer.draw('.timetable');
		}
		*/
		
      	var timetable = new Timetable();
		
		
		
		timetable.setScope(9,15);
      	
		timetable.addLocations(['Lunes', 'Martes', 'Miércoles', 'Jueves', 'Viernes', 'Sábado', 'Domingo']);
		
	//	getEventFromDB(idProfesor);
		
		//var param = "'Ocupado',Lunes, new Date(2017,8,19,10,00), new Date(2017,8,19,11,00)";
				timetable.addEvent('Ocupado','Lunes', new Date(2017,8,19,10,00), new Date(2017,8,19,11,00));
				
		
		var renderer = new Timetable.Renderer(timetable);
		
		renderer.draw('.timetable');
  
    </script>
	<!--script>
		$(function() {
    		$( "#datepicker" ).datepicker();
		});
	</script-->
	<script>
		
	</script>

</html>	